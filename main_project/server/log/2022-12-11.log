2022-12-11 01:20:15,076 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 01:20:15,076 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 01:20:33,183 INFO app Thread-2 (process_request_thread) : All users were selected from database
2022-12-11 01:20:33,183 INFO werkzeug Thread-2 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 01:20:33] "GET /api/v1/get_all_positions HTTP/1.1" 200 -
2022-12-11 01:20:33,440 INFO app Thread-3 (process_request_thread) : All users were selected from database
2022-12-11 01:20:33,442 INFO werkzeug Thread-3 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 01:20:33] "GET /api/v1/get_all_positions HTTP/1.1" 200 -
2022-12-11 01:20:45,888 ERROR app Thread-1 (process_request_thread) : Exception on /api/v1/num_visits [GET]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 598, in connect
    sock = self.retry.call_with_retry(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\retry.py", line 46, in call_with_retry
    return do()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 599, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 664, in _connect
    raise err
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 652, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [WinError 10061] Подключение не установлено, т.к. конечный компьютер отверг запрос на подключение

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 23, in num_visits
    count = get_hit_counts()
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\utils.py", line 12, in get_hit_counts
    raise exc
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\utils.py", line 9, in get_hit_counts
    return cache.incr('hits')
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\commands\core.py", line 1852, in incrby
    return self.execute_command("INCRBY", name, amount)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\client.py", line 1255, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 1389, in get_connection
    connection.connect()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 604, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 10061 connecting to 127.0.0.1:6379. Подключение не установлено, т.к. конечный компьютер отверг запрос на подключение.
2022-12-11 01:20:45,935 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 01:20:45] "[35m[1mGET /api/v1/num_visits HTTP/1.1[0m" 500 -
2022-12-11 01:21:59,202 ERROR app Thread-5 (process_request_thread) : Exception on /api/v1/delete_position [DELETE]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.ForeignKeyViolation: ОШИБКА:  UPDATE или DELETE в таблице "position" нарушает ограничение внешнего ключа "people_position_id_fkey" таблицы "people"
DETAIL:  На ключ (id)=(3) всё ещё есть ссылки в таблице "people".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 132, in delete_position
    session.query(Positon).filter(Positon.id == data["id"]).delete()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\query.py", line 3213, in delete
    result = self.session.execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 1712, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.ForeignKeyViolation) ОШИБКА:  UPDATE или DELETE в таблице "position" нарушает ограничение внешнего ключа "people_position_id_fkey" таблицы "people"
DETAIL:  На ключ (id)=(3) всё ещё есть ссылки в таблице "people".

[SQL: DELETE FROM position WHERE position.id = %(id_1)s]
[parameters: {'id_1': 3}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2022-12-11 01:21:59,267 INFO werkzeug Thread-5 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 01:21:59] "[35m[1mDELETE /api/v1/delete_position HTTP/1.1[0m" 500 -
2022-12-11 01:22:41,086 ERROR app Thread-6 (process_request_thread) : Exception on /api/v1/delete_position [DELETE]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InFailedSqlTransaction: ОШИБКА:  текущая транзакция прервана, команды до конца блока транзакции игнорируются


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 132, in delete_position
    session.query(Positon).filter(Positon.id == data["id"]).delete()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\query.py", line 3213, in delete
    result = self.session.execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 1712, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.errors.InFailedSqlTransaction) ОШИБКА:  текущая транзакция прервана, команды до конца блока транзакции игнорируются

[SQL: DELETE FROM position WHERE position.id = %(id_1)s]
[parameters: {'id_1': 3}]
(Background on this error at: https://sqlalche.me/e/14/2j85)
2022-12-11 01:22:41,087 INFO werkzeug Thread-6 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 01:22:41] "[35m[1mDELETE /api/v1/delete_position HTTP/1.1[0m" 500 -
2022-12-11 01:22:47,185 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 01:22:47,185 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 01:22:52,039 ERROR app Thread-1 (process_request_thread) : Exception on /api/v1/delete_position [DELETE]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.ForeignKeyViolation: ОШИБКА:  UPDATE или DELETE в таблице "position" нарушает ограничение внешнего ключа "people_position_id_fkey" таблицы "people"
DETAIL:  На ключ (id)=(3) всё ещё есть ссылки в таблице "people".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 132, in delete_position
    session.query(Positon).filter(Positon.id == data["id"]).delete()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\query.py", line 3213, in delete
    result = self.session.execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 1712, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.ForeignKeyViolation) ОШИБКА:  UPDATE или DELETE в таблице "position" нарушает ограничение внешнего ключа "people_position_id_fkey" таблицы "people"
DETAIL:  На ключ (id)=(3) всё ещё есть ссылки в таблице "people".

[SQL: DELETE FROM position WHERE position.id = %(id_1)s]
[parameters: {'id_1': 3}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2022-12-11 01:22:52,047 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 01:22:52] "[35m[1mDELETE /api/v1/delete_position HTTP/1.1[0m" 500 -
2022-12-11 01:24:25,914 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 01:24:25,914 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 01:24:29,812 ERROR app Thread-1 (process_request_thread) : Exception on /api/v1/delete_position [DELETE]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.ForeignKeyViolation: ОШИБКА:  UPDATE или DELETE в таблице "position" нарушает ограничение внешнего ключа "people_position_id_fkey" таблицы "people"
DETAIL:  На ключ (id)=(3) всё ещё есть ссылки в таблице "people".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 132, in delete_position
    session.query(Positon).filter(Positon.id == data["id"]).delete()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\query.py", line 3213, in delete
    result = self.session.execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 1712, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.ForeignKeyViolation) ОШИБКА:  UPDATE или DELETE в таблице "position" нарушает ограничение внешнего ключа "people_position_id_fkey" таблицы "people"
DETAIL:  На ключ (id)=(3) всё ещё есть ссылки в таблице "people".

[SQL: DELETE FROM position WHERE position.id = %(id_1)s]
[parameters: {'id_1': 3}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2022-12-11 01:24:29,819 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 01:24:29] "[35m[1mDELETE /api/v1/delete_position HTTP/1.1[0m" 500 -
2022-12-11 01:25:45,409 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 01:25:45,409 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 01:25:52,034 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 01:25:52] "DELETE /api/v1/delete_position HTTP/1.1" 200 -
2022-12-11 01:33:09,460 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 01:33:09,460 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 01:33:17,432 INFO app Thread-1 (process_request_thread) : All users were selected from database
2022-12-11 01:33:17,433 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 01:33:17] "GET /api/v1/get_all_positions HTTP/1.1" 200 -
2022-12-11 01:33:19,633 INFO app Thread-2 (process_request_thread) : All users were selected from database
2022-12-11 01:33:19,634 INFO werkzeug Thread-2 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 01:33:19] "GET /api/v1/get_all_positions HTTP/1.1" 200 -
2022-12-11 01:34:46,208 INFO app Thread-3 (process_request_thread) : All users were selected from database
2022-12-11 01:34:46,210 INFO werkzeug Thread-3 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 01:34:46] "GET /api/v1/get_all_positions HTTP/1.1" 200 -
2022-12-11 01:34:46,474 INFO app Thread-4 (process_request_thread) : All users were selected from database
2022-12-11 01:34:46,476 INFO werkzeug Thread-4 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 01:34:46] "GET /api/v1/get_all_positions HTTP/1.1" 200 -
2022-12-11 01:34:51,418 INFO werkzeug Thread-6 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 01:34:51] "OPTIONS /api/v1/delete_position HTTP/1.1" 200 -
2022-12-11 01:34:51,427 INFO werkzeug Thread-7 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 01:34:51] "DELETE /api/v1/delete_position HTTP/1.1" 200 -
2022-12-11 01:34:58,670 INFO app Thread-5 (process_request_thread) : All users were selected from database
2022-12-11 01:34:58,671 INFO werkzeug Thread-5 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 01:34:58] "GET /api/v1/get_all_positions HTTP/1.1" 200 -
2022-12-11 01:34:58,996 INFO app Thread-8 (process_request_thread) : All users were selected from database
2022-12-11 01:34:58,996 INFO werkzeug Thread-8 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 01:34:58] "GET /api/v1/get_all_positions HTTP/1.1" 200 -
2022-12-11 01:35:23,699 INFO app Thread-10 (process_request_thread) : All users were selected from database
2022-12-11 01:35:23,700 INFO werkzeug Thread-10 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 01:35:23] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 01:35:23,723 INFO app Thread-11 (process_request_thread) : All users were selected from database
2022-12-11 01:35:23,723 INFO werkzeug Thread-11 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 01:35:23] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 12:13:22,365 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 12:13:22,365 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 12:13:27,889 INFO app Thread-2 (process_request_thread) : All users were selected from database
2022-12-11 12:13:27,890 INFO werkzeug Thread-2 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 12:13:27] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 12:13:27,915 INFO app Thread-3 (process_request_thread) : All users were selected from database
2022-12-11 12:13:27,915 INFO werkzeug Thread-3 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 12:13:27] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 12:13:40,862 ERROR app Thread-1 (process_request_thread) : Exception on /api/v1/num_visits [GET]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 598, in connect
    sock = self.retry.call_with_retry(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\retry.py", line 46, in call_with_retry
    return do()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 599, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 664, in _connect
    raise err
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 652, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [WinError 10061] Подключение не установлено, т.к. конечный компьютер отверг запрос на подключение

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 23, in num_visits
    count = get_hit_counts()
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\utils.py", line 12, in get_hit_counts
    raise exc
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\utils.py", line 9, in get_hit_counts
    return cache.incr('hits')
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\commands\core.py", line 1852, in incrby
    return self.execute_command("INCRBY", name, amount)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\client.py", line 1255, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 1389, in get_connection
    connection.connect()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 604, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 10061 connecting to 127.0.0.1:6379. Подключение не установлено, т.к. конечный компьютер отверг запрос на подключение.
2022-12-11 12:13:40,889 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 12:13:40] "[35m[1mGET /api/v1/num_visits HTTP/1.1[0m" 500 -
2022-12-11 12:13:45,900 ERROR app Thread-4 (process_request_thread) : Exception on /api/v1/add_position [POST]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 103, in add_position
    data["departament"],
KeyError: 'departament'
2022-12-11 12:13:45,900 INFO werkzeug Thread-4 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 12:13:45] "[35m[1mPOST /api/v1/add_position HTTP/1.1[0m" 500 -
2022-12-11 12:17:41,049 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 12:17:41,049 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 12:17:50,883 INFO app Thread-1 (process_request_thread) : All users were selected from database
2022-12-11 12:17:50,883 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 12:17:50] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 12:17:50,903 INFO app Thread-2 (process_request_thread) : All users were selected from database
2022-12-11 12:17:50,904 INFO werkzeug Thread-2 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 12:17:50] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 12:18:29,244 ERROR app Thread-3 (process_request_thread) : Exception on /api/v1/add_phone_to_user [POST]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 118, in add_phone_to_user
    person.phones = [data["phone"]]
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\attributes.py", line 460, in __set__
    self.impl.set(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\attributes.py", line 1603, in set
    collections.bulk_replace(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\collections.py", line 843, in bulk_replace
    appender(member, _sa_initiator=initiator)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\collections.py", line 1169, in append
    item = __set(self, item, _sa_initiator)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\collections.py", line 1134, in __set
    item = executor.fire_append_event(item, _sa_initiator)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\collections.py", line 753, in fire_append_event
    return self.attr.fire_append_event(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\attributes.py", line 1430, in fire_append_event
    value = fn(state, value, initiator or self._append_token)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\unitofwork.py", line 56, in append
    item_state = attributes.instance_state(item)
AttributeError: 'str' object has no attribute '_sa_instance_state'
2022-12-11 12:18:29,280 INFO werkzeug Thread-3 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 12:18:29] "[35m[1mPOST /api/v1/add_phone_to_user HTTP/1.1[0m" 500 -
2022-12-11 12:19:27,279 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 12:19:27,279 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 12:19:35,281 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 12:19:35] "POST /api/v1/add_phone_to_user HTTP/1.1" 200 -
2022-12-11 12:20:40,450 INFO app Thread-4 (process_request_thread) : All users were selected from database
2022-12-11 12:20:40,450 INFO werkzeug Thread-4 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 12:20:40] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 12:20:40,471 INFO app Thread-5 (process_request_thread) : All users were selected from database
2022-12-11 12:20:40,472 INFO werkzeug Thread-5 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 12:20:40] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 12:20:46,767 ERROR app Thread-2 (process_request_thread) : Exception on /api/v1/num_visits [GET]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 598, in connect
    sock = self.retry.call_with_retry(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\retry.py", line 46, in call_with_retry
    return do()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 599, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 664, in _connect
    raise err
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 652, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [WinError 10061] Подключение не установлено, т.к. конечный компьютер отверг запрос на подключение

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 23, in num_visits
    count = get_hit_counts()
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\utils.py", line 12, in get_hit_counts
    raise exc
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\utils.py", line 9, in get_hit_counts
    return cache.incr('hits')
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\commands\core.py", line 1852, in incrby
    return self.execute_command("INCRBY", name, amount)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\client.py", line 1255, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 1389, in get_connection
    connection.connect()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 604, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 10061 connecting to 127.0.0.1:6379. Подключение не установлено, т.к. конечный компьютер отверг запрос на подключение.
2022-12-11 12:20:46,767 INFO werkzeug Thread-2 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 12:20:46] "[35m[1mGET /api/v1/num_visits HTTP/1.1[0m" 500 -
2022-12-11 12:20:57,124 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 12:20:57,124 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 12:21:00,702 ERROR app Thread-1 (process_request_thread) : Exception on /api/v1/add_phone_to_user [POST]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 119, in add_phone_to_user
    person.phones = [data["phone"]]
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\attributes.py", line 460, in __set__
    self.impl.set(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\attributes.py", line 1603, in set
    collections.bulk_replace(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\collections.py", line 843, in bulk_replace
    appender(member, _sa_initiator=initiator)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\collections.py", line 1169, in append
    item = __set(self, item, _sa_initiator)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\collections.py", line 1134, in __set
    item = executor.fire_append_event(item, _sa_initiator)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\collections.py", line 753, in fire_append_event
    return self.attr.fire_append_event(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\attributes.py", line 1430, in fire_append_event
    value = fn(state, value, initiator or self._append_token)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\unitofwork.py", line 56, in append
    item_state = attributes.instance_state(item)
AttributeError: 'str' object has no attribute '_sa_instance_state'
2022-12-11 12:21:00,705 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 12:21:00] "[35m[1mPOST /api/v1/add_phone_to_user HTTP/1.1[0m" 500 -
2022-12-11 12:21:52,023 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 12:21:52,023 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 12:21:57,340 ERROR app Thread-1 (process_request_thread) : Exception on /api/v1/add_phone_to_user [POST]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 119, in add_phone_to_user
    person.phones = [data["phone"]]
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\attributes.py", line 460, in __set__
    self.impl.set(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\attributes.py", line 1603, in set
    collections.bulk_replace(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\collections.py", line 843, in bulk_replace
    appender(member, _sa_initiator=initiator)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\collections.py", line 1169, in append
    item = __set(self, item, _sa_initiator)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\collections.py", line 1134, in __set
    item = executor.fire_append_event(item, _sa_initiator)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\collections.py", line 753, in fire_append_event
    return self.attr.fire_append_event(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\attributes.py", line 1430, in fire_append_event
    value = fn(state, value, initiator or self._append_token)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\unitofwork.py", line 56, in append
    item_state = attributes.instance_state(item)
AttributeError: 'str' object has no attribute '_sa_instance_state'
2022-12-11 12:21:57,344 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 12:21:57] "[35m[1mPOST /api/v1/add_phone_to_user HTTP/1.1[0m" 500 -
2022-12-11 12:23:36,447 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 12:23:36,447 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 12:23:39,915 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 12:23:39] "POST /api/v1/add_phone_to_user HTTP/1.1" 200 -
2022-12-11 12:26:36,131 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 12:26:36,131 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 12:26:39,324 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 12:26:39] "POST /api/v1/add_phone_to_user HTTP/1.1" 200 -
2022-12-11 12:28:30,183 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 12:28:30,183 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 12:28:34,050 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 12:28:34] "POST /api/v1/add_phone_to_user HTTP/1.1" 200 -
2022-12-11 12:37:45,004 INFO app Thread-2 (process_request_thread) : All users were selected from database
2022-12-11 12:37:45,005 INFO werkzeug Thread-2 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 12:37:45] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 12:37:45,025 INFO app Thread-3 (process_request_thread) : All users were selected from database
2022-12-11 12:37:45,026 INFO werkzeug Thread-3 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 12:37:45] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 12:39:31,898 INFO werkzeug Thread-4 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 12:39:31] "OPTIONS /api/v1/add_phone_to_user HTTP/1.1" 200 -
2022-12-11 12:39:32,146 INFO werkzeug Thread-5 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 12:39:32] "POST /api/v1/add_phone_to_user HTTP/1.1" 200 -
2022-12-11 12:39:36,778 INFO app Thread-7 (process_request_thread) : All users were selected from database
2022-12-11 12:39:36,779 INFO werkzeug Thread-7 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 12:39:36] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 12:39:36,800 INFO app Thread-8 (process_request_thread) : All users were selected from database
2022-12-11 12:39:36,800 INFO werkzeug Thread-8 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 12:39:36] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 14:15:59,225 INFO app Thread-10 (process_request_thread) : All users were selected from database
2022-12-11 14:15:59,226 INFO werkzeug Thread-10 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:15:59] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 14:15:59,247 INFO app Thread-11 (process_request_thread) : All users were selected from database
2022-12-11 14:15:59,247 INFO werkzeug Thread-11 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:15:59] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 14:16:09,716 ERROR app Thread-9 (process_request_thread) : Exception on /api/v1/num_visits [GET]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 598, in connect
    sock = self.retry.call_with_retry(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\retry.py", line 46, in call_with_retry
    return do()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 599, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 664, in _connect
    raise err
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 652, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [WinError 10061] Подключение не установлено, т.к. конечный компьютер отверг запрос на подключение

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 23, in num_visits
    count = get_hit_counts()
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\utils.py", line 12, in get_hit_counts
    raise exc
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\utils.py", line 9, in get_hit_counts
    return cache.incr('hits')
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\commands\core.py", line 1852, in incrby
    return self.execute_command("INCRBY", name, amount)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\client.py", line 1255, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 1389, in get_connection
    connection.connect()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 604, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 10061 connecting to 127.0.0.1:6379. Подключение не установлено, т.к. конечный компьютер отверг запрос на подключение.
2022-12-11 14:16:09,716 INFO werkzeug Thread-9 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:16:09] "[35m[1mGET /api/v1/num_visits HTTP/1.1[0m" 500 -
2022-12-11 14:16:55,836 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 14:16:55,836 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 14:17:07,934 INFO app Thread-1 (process_request_thread) : All users were selected from database
2022-12-11 14:17:07,935 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:17:07] "GET /api/v1/get_all_positions HTTP/1.1" 200 -
2022-12-11 14:17:22,724 WARNING app Thread-2 (process_request_thread) : Exeption 'list' object has no attribute 'phone' ocured
2022-12-11 14:17:22,724 ERROR app Thread-2 (process_request_thread) : Exception on /api/v1/get_all_people_data [GET]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2162, in make_response
    raise TypeError(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2158, in make_response
    rv = self.response_class.force_type(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\wrappers\response.py", line 268, in force_type
    response = Response(*run_wsgi_app(response, environ))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\test.py", line 1260, in run_wsgi_app
    for item in app_iter:
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\wsgi.py", line 500, in __next__
    return self._next()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\wrappers\response.py", line 50, in _iter_encoded
    for item in iterable:
TypeError: 'AttributeError' object is not iterable
The view function did not return a valid response. The return type must be a string, dict, list, tuple with headers or status, Response instance, or WSGI callable, but it was a HTTPException.
2022-12-11 14:17:22,756 INFO werkzeug Thread-2 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:17:22] "[35m[1mGET /api/v1/get_all_people_data HTTP/1.1[0m" 500 -
2022-12-11 14:18:02,118 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 14:18:02,118 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 14:18:07,909 INFO app Thread-1 (process_request_thread) : All users were selected from database
2022-12-11 14:18:07,909 ERROR app Thread-1 (process_request_thread) : Exception on /api/v1/get_all_people_data [GET]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1823, in full_dispatch_request
    return self.finalize_request(rv)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1842, in finalize_request
    response = self.make_response(rv)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2153, in make_response
    rv = self.json.response(rv)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\json\provider.py", line 309, in response
    f"{self.dumps(obj, **dump_args)}\n", mimetype=mimetype
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\json\provider.py", line 230, in dumps
    return json.dumps(obj, **kwargs)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.2544.0_x64__qbz5n2kfra8p0\lib\json\__init__.py", line 238, in dumps
    **kw).encode(obj)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.2544.0_x64__qbz5n2kfra8p0\lib\json\encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.2544.0_x64__qbz5n2kfra8p0\lib\json\encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\json\provider.py", line 122, in _default
    raise TypeError(f"Object of type {type(o).__name__} is not JSON serializable")
TypeError: Object of type Phone is not JSON serializable
2022-12-11 14:18:07,921 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:18:07] "[35m[1mGET /api/v1/get_all_people_data HTTP/1.1[0m" 500 -
2022-12-11 14:18:28,129 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 14:18:28,129 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 14:18:34,398 INFO app Thread-1 (process_request_thread) : All users were selected from database
2022-12-11 14:18:34,398 ERROR app Thread-1 (process_request_thread) : Exception on /api/v1/get_all_people_data [GET]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1823, in full_dispatch_request
    return self.finalize_request(rv)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1842, in finalize_request
    response = self.make_response(rv)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2153, in make_response
    rv = self.json.response(rv)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\json\provider.py", line 309, in response
    f"{self.dumps(obj, **dump_args)}\n", mimetype=mimetype
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\json\provider.py", line 230, in dumps
    return json.dumps(obj, **kwargs)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.2544.0_x64__qbz5n2kfra8p0\lib\json\__init__.py", line 238, in dumps
    **kw).encode(obj)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.2544.0_x64__qbz5n2kfra8p0\lib\json\encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.2544.0_x64__qbz5n2kfra8p0\lib\json\encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\json\provider.py", line 122, in _default
    raise TypeError(f"Object of type {type(o).__name__} is not JSON serializable")
TypeError: Object of type Phone is not JSON serializable
2022-12-11 14:18:34,401 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:18:34] "[35m[1mGET /api/v1/get_all_people_data HTTP/1.1[0m" 500 -
2022-12-11 14:19:37,590 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 14:19:37,590 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 14:19:43,445 INFO app Thread-1 (process_request_thread) : All users were selected from database
2022-12-11 14:19:43,446 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:19:43] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 14:24:41,070 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 14:24:41,070 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 14:24:45,667 INFO app Thread-1 (process_request_thread) : All users were selected from database
2022-12-11 14:24:45,668 ERROR app Thread-1 (process_request_thread) : Exception on /api/v1/get_all_people_data [GET]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1823, in full_dispatch_request
    return self.finalize_request(rv)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1842, in finalize_request
    response = self.make_response(rv)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2153, in make_response
    rv = self.json.response(rv)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\json\provider.py", line 309, in response
    f"{self.dumps(obj, **dump_args)}\n", mimetype=mimetype
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\json\provider.py", line 230, in dumps
    return json.dumps(obj, **kwargs)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.2544.0_x64__qbz5n2kfra8p0\lib\json\__init__.py", line 238, in dumps
    **kw).encode(obj)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.2544.0_x64__qbz5n2kfra8p0\lib\json\encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.2544.0_x64__qbz5n2kfra8p0\lib\json\encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\json\provider.py", line 122, in _default
    raise TypeError(f"Object of type {type(o).__name__} is not JSON serializable")
TypeError: Object of type Phone is not JSON serializable
2022-12-11 14:24:45,671 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:24:45] "[35m[1mGET /api/v1/get_all_people_data HTTP/1.1[0m" 500 -
2022-12-11 14:26:46,881 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 14:26:46,881 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 14:26:53,814 INFO app Thread-1 (process_request_thread) : All users were selected from database
2022-12-11 14:26:53,814 ERROR app Thread-1 (process_request_thread) : Exception on /api/v1/get_all_people_data [GET]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1823, in full_dispatch_request
    return self.finalize_request(rv)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1842, in finalize_request
    response = self.make_response(rv)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2153, in make_response
    rv = self.json.response(rv)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\json\provider.py", line 309, in response
    f"{self.dumps(obj, **dump_args)}\n", mimetype=mimetype
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\json\provider.py", line 230, in dumps
    return json.dumps(obj, **kwargs)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.2544.0_x64__qbz5n2kfra8p0\lib\json\__init__.py", line 238, in dumps
    **kw).encode(obj)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.2544.0_x64__qbz5n2kfra8p0\lib\json\encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.2544.0_x64__qbz5n2kfra8p0\lib\json\encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\json\provider.py", line 122, in _default
    raise TypeError(f"Object of type {type(o).__name__} is not JSON serializable")
TypeError: Object of type map is not JSON serializable
2022-12-11 14:26:53,816 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:26:53] "[35m[1mGET /api/v1/get_all_people_data HTTP/1.1[0m" 500 -
2022-12-11 14:27:44,323 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 14:27:44,323 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 14:27:58,102 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 14:27:58,102 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 14:28:03,079 INFO app Thread-1 (process_request_thread) : All users were selected from database
2022-12-11 14:28:03,080 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:28:03] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 14:28:48,300 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 14:28:48,315 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 14:28:55,349 INFO app Thread-1 (process_request_thread) : All users were selected from database
2022-12-11 14:28:55,350 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:28:55] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 14:30:00,142 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 14:30:00,142 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 14:30:04,849 INFO app Thread-1 (process_request_thread) : All users were selected from database
2022-12-11 14:30:04,850 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:30:04] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 14:30:12,540 INFO app Thread-2 (process_request_thread) : All users were selected from database
2022-12-11 14:30:12,541 INFO werkzeug Thread-2 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:30:12] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 14:30:12,567 INFO app Thread-3 (process_request_thread) : All users were selected from database
2022-12-11 14:30:12,568 INFO werkzeug Thread-3 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:30:12] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 14:32:18,821 INFO app Thread-4 (process_request_thread) : All users were selected from database
2022-12-11 14:32:18,822 INFO werkzeug Thread-4 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:32:18] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 14:32:18,869 INFO app Thread-5 (process_request_thread) : All users were selected from database
2022-12-11 14:32:18,870 INFO werkzeug Thread-5 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:32:18] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 14:32:18,917 INFO app Thread-6 (process_request_thread) : All users were selected from database
2022-12-11 14:32:18,918 INFO werkzeug Thread-6 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:32:18] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 14:32:18,950 INFO app Thread-7 (process_request_thread) : All users were selected from database
2022-12-11 14:32:18,951 INFO werkzeug Thread-7 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:32:18] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 14:32:19,029 INFO app Thread-8 (process_request_thread) : All users were selected from database
2022-12-11 14:32:19,030 INFO werkzeug Thread-8 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:32:19] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 14:32:19,074 INFO app Thread-9 (process_request_thread) : All users were selected from database
2022-12-11 14:32:19,075 INFO werkzeug Thread-9 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:32:19] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 14:35:21,303 ERROR app Thread-10 (process_request_thread) : Exception on /api/v1/delete_phone [DELETE]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 152, in delete_phone
    session.query(Phone).filter(Person.phone == data["phone"]).delete()
AttributeError: type object 'Person' has no attribute 'phone'
2022-12-11 14:35:21,305 INFO werkzeug Thread-10 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:35:21] "[35m[1mDELETE /api/v1/delete_phone HTTP/1.1[0m" 500 -
2022-12-11 14:35:55,130 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 14:35:55,130 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 14:35:59,294 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:35:59] "DELETE /api/v1/delete_phone HTTP/1.1" 200 -
2022-12-11 14:36:07,939 INFO app Thread-2 (process_request_thread) : All users were selected from database
2022-12-11 14:36:07,939 INFO werkzeug Thread-2 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:36:07] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 14:36:07,962 INFO app Thread-3 (process_request_thread) : All users were selected from database
2022-12-11 14:36:07,962 INFO werkzeug Thread-3 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:36:07] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 14:43:56,687 INFO werkzeug Thread-4 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:43:56] "OPTIONS /api/v1/delete_phone HTTP/1.1" 200 -
2022-12-11 14:43:56,952 ERROR app Thread-5 (process_request_thread) : Exception on /api/v1/delete_phone [DELETE]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: ОШИБКА:  оператор не существует: character varying = text[]
LINE 1: DELETE FROM phone WHERE phone.phone = ARRAY['new_phone5']
                                            ^
HINT:  Оператор с данными именем и типами аргументов не найден. Возможно, вам следует добавить явные приведения типов.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 152, in delete_phone
    session.query(Phone).filter(Phone.phone == data["phone"]).delete()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\query.py", line 3213, in delete
    result = self.session.execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 1712, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) ОШИБКА:  оператор не существует: character varying = text[]
LINE 1: DELETE FROM phone WHERE phone.phone = ARRAY['new_phone5']
                                            ^
HINT:  Оператор с данными именем и типами аргументов не найден. Возможно, вам следует добавить явные приведения типов.

[SQL: DELETE FROM phone WHERE phone.phone = %(phone_1)s]
[parameters: {'phone_1': ['new_phone5']}]
(Background on this error at: https://sqlalche.me/e/14/f405)
2022-12-11 14:43:56,968 INFO werkzeug Thread-5 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:43:56] "[35m[1mDELETE /api/v1/delete_phone HTTP/1.1[0m" 500 -
2022-12-11 14:44:15,620 ERROR app Thread-7 (process_request_thread) : Exception on /api/v1/add_phone_to_user [POST]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InFailedSqlTransaction: ОШИБКА:  текущая транзакция прервана, команды до конца блока транзакции игнорируются


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 125, in add_phone_to_user
    .first()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\query.py", line 2823, in first
    return self.limit(1)._iter().first()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\query.py", line 2907, in _iter
    result = self.session.execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 1712, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.errors.InFailedSqlTransaction) ОШИБКА:  текущая транзакция прервана, команды до конца блока транзакции игнорируются

[SQL: SELECT people.id AS people_id, people.last_name AS people_last_name, people.first_name AS people_first_name, people.position_id AS people_position_id 
FROM people 
WHERE people.id = %(id_1)s 
 LIMIT %(param_1)s]
[parameters: {'id_1': 2, 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/14/2j85)
2022-12-11 14:44:15,621 INFO werkzeug Thread-7 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:44:15] "[35m[1mPOST /api/v1/add_phone_to_user HTTP/1.1[0m" 500 -
2022-12-11 14:44:35,647 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 14:44:35,647 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 14:44:41,868 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:44:41] "POST /api/v1/add_phone_to_user HTTP/1.1" 200 -
2022-12-11 14:44:49,601 INFO app Thread-2 (process_request_thread) : All users were selected from database
2022-12-11 14:44:49,602 INFO werkzeug Thread-2 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:44:49] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 14:44:49,631 INFO app Thread-3 (process_request_thread) : All users were selected from database
2022-12-11 14:44:49,632 INFO werkzeug Thread-3 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:44:49] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 14:45:34,827 INFO werkzeug Thread-4 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:45:34] "OPTIONS /api/v1/delete_phone HTTP/1.1" 200 -
2022-12-11 14:45:35,079 ERROR app Thread-5 (process_request_thread) : Exception on /api/v1/delete_phone [DELETE]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: ОШИБКА:  оператор не существует: character varying = text[]
LINE 1: DELETE FROM phone WHERE phone.phone = ARRAY['+13459875667','...
                                            ^
HINT:  Оператор с данными именем и типами аргументов не найден. Возможно, вам следует добавить явные приведения типов.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 152, in delete_phone
    session.query(Phone).filter(Phone.phone == data["phone"]).delete()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\query.py", line 3213, in delete
    result = self.session.execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 1712, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) ОШИБКА:  оператор не существует: character varying = text[]
LINE 1: DELETE FROM phone WHERE phone.phone = ARRAY['+13459875667','...
                                            ^
HINT:  Оператор с данными именем и типами аргументов не найден. Возможно, вам следует добавить явные приведения типов.

[SQL: DELETE FROM phone WHERE phone.phone = %(phone_1)s]
[parameters: {'phone_1': ['+13459875667', 'test phone']}]
(Background on this error at: https://sqlalche.me/e/14/f405)
2022-12-11 14:45:35,094 INFO werkzeug Thread-5 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:45:35] "[35m[1mDELETE /api/v1/delete_phone HTTP/1.1[0m" 500 -
2022-12-11 14:47:21,611 WARNING app Thread-7 (process_request_thread) : Exeption (psycopg2.errors.InFailedSqlTransaction) ОШИБКА:  текущая транзакция прервана, команды до конца блока транзакции игнорируются

[SQL: SELECT people.id AS people_id, people.last_name AS people_last_name, people.first_name AS people_first_name, people.position_id AS people_position_id 
FROM people]
(Background on this error at: https://sqlalche.me/e/14/2j85) ocured
2022-12-11 14:47:21,611 ERROR app Thread-7 (process_request_thread) : Exception on /api/v1/get_all_people_data [GET]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2162, in make_response
    raise TypeError(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2158, in make_response
    rv = self.response_class.force_type(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\wrappers\response.py", line 268, in force_type
    response = Response(*run_wsgi_app(response, environ))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\test.py", line 1260, in run_wsgi_app
    for item in app_iter:
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\wsgi.py", line 500, in __next__
    return self._next()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\wrappers\response.py", line 50, in _iter_encoded
    for item in iterable:
TypeError: 'InternalError' object is not iterable
The view function did not return a valid response. The return type must be a string, dict, list, tuple with headers or status, Response instance, or WSGI callable, but it was a HTTPException.
2022-12-11 14:47:21,615 INFO werkzeug Thread-7 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:47:21] "[35m[1mGET /api/v1/get_all_people_data HTTP/1.1[0m" 500 -
2022-12-11 14:47:21,619 WARNING app Thread-8 (process_request_thread) : Exeption (psycopg2.errors.InFailedSqlTransaction) ОШИБКА:  текущая транзакция прервана, команды до конца блока транзакции игнорируются

[SQL: SELECT people.id AS people_id, people.last_name AS people_last_name, people.first_name AS people_first_name, people.position_id AS people_position_id 
FROM people]
(Background on this error at: https://sqlalche.me/e/14/2j85) ocured
2022-12-11 14:47:21,620 ERROR app Thread-8 (process_request_thread) : Exception on /api/v1/get_all_people_data [GET]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2162, in make_response
    raise TypeError(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2158, in make_response
    rv = self.response_class.force_type(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\wrappers\response.py", line 268, in force_type
    response = Response(*run_wsgi_app(response, environ))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\test.py", line 1260, in run_wsgi_app
    for item in app_iter:
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\wsgi.py", line 500, in __next__
    return self._next()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\wrappers\response.py", line 50, in _iter_encoded
    for item in iterable:
TypeError: 'InternalError' object is not iterable
The view function did not return a valid response. The return type must be a string, dict, list, tuple with headers or status, Response instance, or WSGI callable, but it was a HTTPException.
2022-12-11 14:47:21,621 INFO werkzeug Thread-8 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:47:21] "[35m[1mGET /api/v1/get_all_people_data HTTP/1.1[0m" 500 -
2022-12-11 14:47:24,139 WARNING app Thread-9 (process_request_thread) : Exeption (psycopg2.errors.InFailedSqlTransaction) ОШИБКА:  текущая транзакция прервана, команды до конца блока транзакции игнорируются

[SQL: SELECT people.id AS people_id, people.last_name AS people_last_name, people.first_name AS people_first_name, people.position_id AS people_position_id 
FROM people]
(Background on this error at: https://sqlalche.me/e/14/2j85) ocured
2022-12-11 14:47:24,139 ERROR app Thread-9 (process_request_thread) : Exception on /api/v1/get_all_people_data [GET]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2162, in make_response
    raise TypeError(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2158, in make_response
    rv = self.response_class.force_type(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\wrappers\response.py", line 268, in force_type
    response = Response(*run_wsgi_app(response, environ))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\test.py", line 1260, in run_wsgi_app
    for item in app_iter:
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\wsgi.py", line 500, in __next__
    return self._next()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\wrappers\response.py", line 50, in _iter_encoded
    for item in iterable:
TypeError: 'InternalError' object is not iterable
The view function did not return a valid response. The return type must be a string, dict, list, tuple with headers or status, Response instance, or WSGI callable, but it was a HTTPException.
2022-12-11 14:47:24,140 INFO werkzeug Thread-9 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:47:24] "[35m[1mGET /api/v1/get_all_people_data HTTP/1.1[0m" 500 -
2022-12-11 14:47:24,143 WARNING app Thread-10 (process_request_thread) : Exeption (psycopg2.errors.InFailedSqlTransaction) ОШИБКА:  текущая транзакция прервана, команды до конца блока транзакции игнорируются

[SQL: SELECT people.id AS people_id, people.last_name AS people_last_name, people.first_name AS people_first_name, people.position_id AS people_position_id 
FROM people]
(Background on this error at: https://sqlalche.me/e/14/2j85) ocured
2022-12-11 14:47:24,143 ERROR app Thread-10 (process_request_thread) : Exception on /api/v1/get_all_people_data [GET]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2162, in make_response
    raise TypeError(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2158, in make_response
    rv = self.response_class.force_type(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\wrappers\response.py", line 268, in force_type
    response = Response(*run_wsgi_app(response, environ))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\test.py", line 1260, in run_wsgi_app
    for item in app_iter:
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\wsgi.py", line 500, in __next__
    return self._next()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\wrappers\response.py", line 50, in _iter_encoded
    for item in iterable:
TypeError: 'InternalError' object is not iterable
The view function did not return a valid response. The return type must be a string, dict, list, tuple with headers or status, Response instance, or WSGI callable, but it was a HTTPException.
2022-12-11 14:47:24,145 INFO werkzeug Thread-10 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:47:24] "[35m[1mGET /api/v1/get_all_people_data HTTP/1.1[0m" 500 -
2022-12-11 14:47:37,184 WARNING app Thread-11 (process_request_thread) : Exeption (psycopg2.errors.InFailedSqlTransaction) ОШИБКА:  текущая транзакция прервана, команды до конца блока транзакции игнорируются

[SQL: SELECT people.id AS people_id, people.last_name AS people_last_name, people.first_name AS people_first_name, people.position_id AS people_position_id 
FROM people]
(Background on this error at: https://sqlalche.me/e/14/2j85) ocured
2022-12-11 14:47:37,185 ERROR app Thread-11 (process_request_thread) : Exception on /api/v1/get_all_people_data [GET]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2162, in make_response
    raise TypeError(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2158, in make_response
    rv = self.response_class.force_type(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\wrappers\response.py", line 268, in force_type
    response = Response(*run_wsgi_app(response, environ))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\test.py", line 1260, in run_wsgi_app
    for item in app_iter:
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\wsgi.py", line 500, in __next__
    return self._next()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\wrappers\response.py", line 50, in _iter_encoded
    for item in iterable:
TypeError: 'InternalError' object is not iterable
The view function did not return a valid response. The return type must be a string, dict, list, tuple with headers or status, Response instance, or WSGI callable, but it was a HTTPException.
2022-12-11 14:47:37,185 INFO werkzeug Thread-11 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:47:37] "[35m[1mGET /api/v1/get_all_people_data HTTP/1.1[0m" 500 -
2022-12-11 14:47:43,999 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 14:47:43,999 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 14:47:49,076 INFO app Thread-1 (process_request_thread) : All users were selected from database
2022-12-11 14:47:49,076 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:47:49] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 14:47:53,416 INFO app Thread-2 (process_request_thread) : All users were selected from database
2022-12-11 14:47:53,417 INFO werkzeug Thread-2 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:47:53] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 14:47:53,439 INFO app Thread-3 (process_request_thread) : All users were selected from database
2022-12-11 14:47:53,440 INFO werkzeug Thread-3 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:47:53] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 14:47:57,992 INFO werkzeug Thread-4 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:47:57] "OPTIONS /api/v1/delete_phone HTTP/1.1" 200 -
2022-12-11 14:47:58,260 ERROR app Thread-5 (process_request_thread) : Exception on /api/v1/delete_phone [DELETE]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: ОШИБКА:  оператор не существует: character varying = text[]
LINE 1: DELETE FROM phone WHERE phone.phone = ARRAY['+13459875667','...
                                            ^
HINT:  Оператор с данными именем и типами аргументов не найден. Возможно, вам следует добавить явные приведения типов.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 152, in delete_phone
    session.query(Phone).filter(Phone.phone == data["phone"]).delete()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\query.py", line 3213, in delete
    result = self.session.execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 1712, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) ОШИБКА:  оператор не существует: character varying = text[]
LINE 1: DELETE FROM phone WHERE phone.phone = ARRAY['+13459875667','...
                                            ^
HINT:  Оператор с данными именем и типами аргументов не найден. Возможно, вам следует добавить явные приведения типов.

[SQL: DELETE FROM phone WHERE phone.phone = %(phone_1)s]
[parameters: {'phone_1': ['+13459875667', 'test phone']}]
(Background on this error at: https://sqlalche.me/e/14/f405)
2022-12-11 14:47:58,260 INFO werkzeug Thread-5 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:47:58] "[35m[1mDELETE /api/v1/delete_phone HTTP/1.1[0m" 500 -
2022-12-11 14:49:14,797 INFO werkzeug Thread-7 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:49:14] "OPTIONS /api/v1/delete_phone HTTP/1.1" 200 -
2022-12-11 14:49:15,063 ERROR app Thread-8 (process_request_thread) : Exception on /api/v1/delete_phone [DELETE]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InFailedSqlTransaction: ОШИБКА:  текущая транзакция прервана, команды до конца блока транзакции игнорируются


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 152, in delete_phone
    session.query(Phone).filter(Phone.phone == data["phone"]).delete()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\query.py", line 3213, in delete
    result = self.session.execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 1712, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.errors.InFailedSqlTransaction) ОШИБКА:  текущая транзакция прервана, команды до конца блока транзакции игнорируются

[SQL: DELETE FROM phone WHERE phone.phone = %(phone_1)s]
[parameters: {'phone_1': ['+13459875667', 'test phone']}]
(Background on this error at: https://sqlalche.me/e/14/2j85)
2022-12-11 14:49:15,063 INFO werkzeug Thread-8 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:49:15] "[35m[1mDELETE /api/v1/delete_phone HTTP/1.1[0m" 500 -
2022-12-11 14:49:37,346 INFO werkzeug Thread-9 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:49:37] "OPTIONS /api/v1/delete_phone HTTP/1.1" 200 -
2022-12-11 14:49:37,657 ERROR app Thread-10 (process_request_thread) : Exception on /api/v1/delete_phone [DELETE]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 152, in delete_phone
    session.query(Phone).filter(Phone.phone == data["phone"]).delete()
KeyError: 'phone'
2022-12-11 14:49:37,657 INFO werkzeug Thread-10 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:49:37] "[35m[1mDELETE /api/v1/delete_phone HTTP/1.1[0m" 500 -
2022-12-11 14:49:47,169 INFO werkzeug Thread-11 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:49:47] "OPTIONS /api/v1/delete_phone HTTP/1.1" 200 -
2022-12-11 14:49:47,481 ERROR app Thread-12 (process_request_thread) : Exception on /api/v1/delete_phone [DELETE]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InFailedSqlTransaction: ОШИБКА:  текущая транзакция прервана, команды до конца блока транзакции игнорируются


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 152, in delete_phone
    session.query(Phone).filter(Phone.phone == data["phone"]).delete()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\query.py", line 3213, in delete
    result = self.session.execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 1712, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.errors.InFailedSqlTransaction) ОШИБКА:  текущая транзакция прервана, команды до конца блока транзакции игнорируются

[SQL: DELETE FROM phone WHERE phone.phone = %(phone_1)s]
[parameters: {'phone_1': '+13459875667'}]
(Background on this error at: https://sqlalche.me/e/14/2j85)
2022-12-11 14:49:47,481 INFO werkzeug Thread-12 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:49:47] "[35m[1mDELETE /api/v1/delete_phone HTTP/1.1[0m" 500 -
2022-12-11 14:49:54,678 WARNING app Thread-14 (process_request_thread) : Exeption (psycopg2.errors.InFailedSqlTransaction) ОШИБКА:  текущая транзакция прервана, команды до конца блока транзакции игнорируются

[SQL: SELECT people.id AS people_id, people.last_name AS people_last_name, people.first_name AS people_first_name, people.position_id AS people_position_id 
FROM people]
(Background on this error at: https://sqlalche.me/e/14/2j85) ocured
2022-12-11 14:49:54,678 ERROR app Thread-14 (process_request_thread) : Exception on /api/v1/get_all_people_data [GET]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2162, in make_response
    raise TypeError(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2158, in make_response
    rv = self.response_class.force_type(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\wrappers\response.py", line 268, in force_type
    response = Response(*run_wsgi_app(response, environ))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\test.py", line 1260, in run_wsgi_app
    for item in app_iter:
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\wsgi.py", line 500, in __next__
    return self._next()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\wrappers\response.py", line 50, in _iter_encoded
    for item in iterable:
TypeError: 'InternalError' object is not iterable
The view function did not return a valid response. The return type must be a string, dict, list, tuple with headers or status, Response instance, or WSGI callable, but it was a HTTPException.
2022-12-11 14:49:54,680 INFO werkzeug Thread-14 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:49:54] "[35m[1mGET /api/v1/get_all_people_data HTTP/1.1[0m" 500 -
2022-12-11 14:50:01,074 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 14:50:01,074 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 14:50:06,572 INFO app Thread-1 (process_request_thread) : All users were selected from database
2022-12-11 14:50:06,573 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:50:06] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 14:50:13,639 INFO app Thread-2 (process_request_thread) : All users were selected from database
2022-12-11 14:50:13,640 INFO werkzeug Thread-2 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:50:13] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 14:50:13,664 INFO app Thread-3 (process_request_thread) : All users were selected from database
2022-12-11 14:50:13,664 INFO werkzeug Thread-3 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:50:13] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 14:50:16,432 INFO werkzeug Thread-4 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:50:16] "OPTIONS /api/v1/delete_phone HTTP/1.1" 200 -
2022-12-11 14:50:16,682 INFO werkzeug Thread-5 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:50:16] "DELETE /api/v1/delete_phone HTTP/1.1" 200 -
2022-12-11 14:50:24,340 INFO app Thread-6 (process_request_thread) : All users were selected from database
2022-12-11 14:50:24,341 INFO werkzeug Thread-6 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:50:24] "GET /api/v1/get_all_positions HTTP/1.1" 200 -
2022-12-11 14:50:24,656 INFO app Thread-7 (process_request_thread) : All users were selected from database
2022-12-11 14:50:24,656 INFO werkzeug Thread-7 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:50:24] "GET /api/v1/get_all_positions HTTP/1.1" 200 -
2022-12-11 14:50:27,371 INFO app Thread-9 (process_request_thread) : All users were selected from database
2022-12-11 14:50:27,371 INFO werkzeug Thread-9 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:50:27] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 14:50:27,394 INFO app Thread-10 (process_request_thread) : All users were selected from database
2022-12-11 14:50:27,395 INFO werkzeug Thread-10 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:50:27] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 14:50:43,635 ERROR app Thread-11 (process_request_thread) : Exception on /api/v1/num_visits [GET]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 598, in connect
    sock = self.retry.call_with_retry(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\retry.py", line 46, in call_with_retry
    return do()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 599, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 664, in _connect
    raise err
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 652, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [WinError 10061] Подключение не установлено, т.к. конечный компьютер отверг запрос на подключение

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 23, in num_visits
    count = get_hit_counts()
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\utils.py", line 12, in get_hit_counts
    raise exc
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\utils.py", line 9, in get_hit_counts
    return cache.incr('hits')
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\commands\core.py", line 1852, in incrby
    return self.execute_command("INCRBY", name, amount)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\client.py", line 1255, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 1389, in get_connection
    connection.connect()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 604, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 10061 connecting to 127.0.0.1:6379. Подключение не установлено, т.к. конечный компьютер отверг запрос на подключение.
2022-12-11 14:50:43,642 INFO werkzeug Thread-11 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:50:43] "[35m[1mGET /api/v1/num_visits HTTP/1.1[0m" 500 -
2022-12-11 14:50:58,275 ERROR app Thread-12 (process_request_thread) : Exception on /api/v1/num_visits [GET]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 598, in connect
    sock = self.retry.call_with_retry(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\retry.py", line 46, in call_with_retry
    return do()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 599, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 664, in _connect
    raise err
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 652, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [WinError 10061] Подключение не установлено, т.к. конечный компьютер отверг запрос на подключение

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 23, in num_visits
    count = get_hit_counts()
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\utils.py", line 12, in get_hit_counts
    raise exc
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\utils.py", line 9, in get_hit_counts
    return cache.incr('hits')
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\commands\core.py", line 1852, in incrby
    return self.execute_command("INCRBY", name, amount)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\client.py", line 1255, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 1389, in get_connection
    connection.connect()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 604, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 10061 connecting to 127.0.0.1:6379. Подключение не установлено, т.к. конечный компьютер отверг запрос на подключение.
2022-12-11 14:50:58,275 INFO werkzeug Thread-12 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 14:50:58] "[35m[1mGET /api/v1/num_visits HTTP/1.1[0m" 500 -
2022-12-11 15:13:40,472 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 15:13:40,472 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 15:13:46,084 INFO app Thread-2 (process_request_thread) : All users were selected from database
2022-12-11 15:13:46,084 INFO werkzeug Thread-2 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:13:46] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 15:13:46,112 INFO app Thread-3 (process_request_thread) : All users were selected from database
2022-12-11 15:13:46,112 INFO werkzeug Thread-3 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:13:46] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 15:13:58,121 ERROR app Thread-1 (process_request_thread) : Exception on /api/v1/num_visits [GET]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 598, in connect
    sock = self.retry.call_with_retry(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\retry.py", line 46, in call_with_retry
    return do()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 599, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 664, in _connect
    raise err
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 652, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [WinError 10061] Подключение не установлено, т.к. конечный компьютер отверг запрос на подключение

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 23, in num_visits
    count = get_hit_counts()
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\utils.py", line 12, in get_hit_counts
    raise exc
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\utils.py", line 9, in get_hit_counts
    return cache.incr('hits')
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\commands\core.py", line 1852, in incrby
    return self.execute_command("INCRBY", name, amount)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\client.py", line 1255, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 1389, in get_connection
    connection.connect()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 604, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 10061 connecting to 127.0.0.1:6379. Подключение не установлено, т.к. конечный компьютер отверг запрос на подключение.
2022-12-11 15:13:58,181 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:13:58] "[35m[1mGET /api/v1/num_visits HTTP/1.1[0m" 500 -
2022-12-11 15:20:19,729 INFO werkzeug Thread-4 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:20:19] "OPTIONS /api/v1/add_person HTTP/1.1" 200 -
2022-12-11 15:20:19,979 ERROR app Thread-5 (process_request_thread) : Exception on /api/v1/add_person [POST]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.ForeignKeyViolation: ОШИБКА:  INSERT или UPDATE в таблице "people" нарушает ограничение внешнего ключа "people_position_id_fkey"
DETAIL:  Ключ (position_id)=(4) отсутствует в таблице "position".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 101, in add_person
    session.commit()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 1451, in commit
    self._transaction.commit(_to_root=self.future)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 829, in commit
    self._prepare_impl()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 808, in _prepare_impl
    self.session.flush()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 3386, in flush
    self._flush(objects)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 3525, in _flush
    with util.safe_reraise():
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 3486, in _flush
    flush_context.execute()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\unitofwork.py", line 456, in execute
    rec.execute(self)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\unitofwork.py", line 630, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\persistence.py", line 245, in save_obj
    _emit_insert_statements(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\persistence.py", line 1238, in _emit_insert_statements
    result = connection._execute_20(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.ForeignKeyViolation) ОШИБКА:  INSERT или UPDATE в таблице "people" нарушает ограничение внешнего ключа "people_position_id_fkey"
DETAIL:  Ключ (position_id)=(4) отсутствует в таблице "position".

[SQL: INSERT INTO people (last_name, first_name, position_id) VALUES (%(last_name)s, %(first_name)s, %(position_id)s) RETURNING people.id]
[parameters: {'last_name': 'test', 'first_name': 'test', 'position_id': 4}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2022-12-11 15:20:20,073 INFO werkzeug Thread-5 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:20:20] "[35m[1mPOST /api/v1/add_person HTTP/1.1[0m" 500 -
2022-12-11 15:20:53,531 ERROR app Thread-7 (process_request_thread) : Exception on /api/v1/add_person [POST]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 101, in add_person
    session.commit()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 1451, in commit
    self._transaction.commit(_to_root=self.future)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 827, in commit
    self._assert_active(prepared_ok=True)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (psycopg2.errors.ForeignKeyViolation) ОШИБКА:  INSERT или UPDATE в таблице "people" нарушает ограничение внешнего ключа "people_position_id_fkey"
DETAIL:  Ключ (position_id)=(4) отсутствует в таблице "position".

[SQL: INSERT INTO people (last_name, first_name, position_id) VALUES (%(last_name)s, %(first_name)s, %(position_id)s) RETURNING people.id]
[parameters: {'last_name': 'test', 'first_name': 'test', 'position_id': 4}]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
2022-12-11 15:20:53,532 INFO werkzeug Thread-7 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:20:53] "[35m[1mPOST /api/v1/add_person HTTP/1.1[0m" 500 -
2022-12-11 15:20:59,534 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 15:20:59,534 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 15:21:02,971 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:21:02] "POST /api/v1/add_person HTTP/1.1" 200 -
2022-12-11 15:21:10,994 INFO werkzeug Thread-2 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:21:10] "OPTIONS /api/v1/add_person HTTP/1.1" 200 -
2022-12-11 15:21:11,253 ERROR app Thread-3 (process_request_thread) : Exception on /api/v1/add_person [POST]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.ForeignKeyViolation: ОШИБКА:  INSERT или UPDATE в таблице "people" нарушает ограничение внешнего ключа "people_position_id_fkey"
DETAIL:  Ключ (position_id)=(4) отсутствует в таблице "position".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 101, in add_person
    session.commit()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 1451, in commit
    self._transaction.commit(_to_root=self.future)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 829, in commit
    self._prepare_impl()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 808, in _prepare_impl
    self.session.flush()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 3386, in flush
    self._flush(objects)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 3525, in _flush
    with util.safe_reraise():
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 3486, in _flush
    flush_context.execute()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\unitofwork.py", line 456, in execute
    rec.execute(self)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\unitofwork.py", line 630, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\persistence.py", line 245, in save_obj
    _emit_insert_statements(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\persistence.py", line 1238, in _emit_insert_statements
    result = connection._execute_20(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.ForeignKeyViolation) ОШИБКА:  INSERT или UPDATE в таблице "people" нарушает ограничение внешнего ключа "people_position_id_fkey"
DETAIL:  Ключ (position_id)=(4) отсутствует в таблице "position".

[SQL: INSERT INTO people (last_name, first_name, position_id) VALUES (%(last_name)s, %(first_name)s, %(position_id)s) RETURNING people.id]
[parameters: {'last_name': 'test', 'first_name': 'test', 'position_id': 4}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2022-12-11 15:21:11,253 INFO werkzeug Thread-3 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:21:11] "[35m[1mPOST /api/v1/add_person HTTP/1.1[0m" 500 -
2022-12-11 15:21:47,942 ERROR app Thread-5 (process_request_thread) : Exception on /api/v1/add_person [POST]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 101, in add_person
    session.commit()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 1451, in commit
    self._transaction.commit(_to_root=self.future)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 827, in commit
    self._assert_active(prepared_ok=True)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (psycopg2.errors.ForeignKeyViolation) ОШИБКА:  INSERT или UPDATE в таблице "people" нарушает ограничение внешнего ключа "people_position_id_fkey"
DETAIL:  Ключ (position_id)=(4) отсутствует в таблице "position".

[SQL: INSERT INTO people (last_name, first_name, position_id) VALUES (%(last_name)s, %(first_name)s, %(position_id)s) RETURNING people.id]
[parameters: {'last_name': 'test', 'first_name': 'test', 'position_id': 4}]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
2022-12-11 15:21:47,943 INFO werkzeug Thread-5 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:21:47] "[35m[1mPOST /api/v1/add_person HTTP/1.1[0m" 500 -
2022-12-11 15:21:55,151 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 15:21:55,151 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 15:22:01,140 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:22:01] "OPTIONS /api/v1/add_person HTTP/1.1" 200 -
2022-12-11 15:22:01,407 ERROR app Thread-2 (process_request_thread) : Exception on /api/v1/add_person [POST]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.ForeignKeyViolation: ОШИБКА:  INSERT или UPDATE в таблице "people" нарушает ограничение внешнего ключа "people_position_id_fkey"
DETAIL:  Ключ (position_id)=(4) отсутствует в таблице "position".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 101, in add_person
    session.commit()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 1451, in commit
    self._transaction.commit(_to_root=self.future)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 829, in commit
    self._prepare_impl()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 808, in _prepare_impl
    self.session.flush()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 3386, in flush
    self._flush(objects)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 3525, in _flush
    with util.safe_reraise():
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 3486, in _flush
    flush_context.execute()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\unitofwork.py", line 456, in execute
    rec.execute(self)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\unitofwork.py", line 630, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\persistence.py", line 245, in save_obj
    _emit_insert_statements(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\persistence.py", line 1238, in _emit_insert_statements
    result = connection._execute_20(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.ForeignKeyViolation) ОШИБКА:  INSERT или UPDATE в таблице "people" нарушает ограничение внешнего ключа "people_position_id_fkey"
DETAIL:  Ключ (position_id)=(4) отсутствует в таблице "position".

[SQL: INSERT INTO people (last_name, first_name, position_id) VALUES (%(last_name)s, %(first_name)s, %(position_id)s) RETURNING people.id]
[parameters: {'last_name': 'test', 'first_name': 'test', 'position_id': 4}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2022-12-11 15:22:01,422 INFO werkzeug Thread-2 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:22:01] "[35m[1mPOST /api/v1/add_person HTTP/1.1[0m" 500 -
2022-12-11 15:22:04,172 ERROR app Thread-4 (process_request_thread) : Exception on /api/v1/add_person [POST]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 101, in add_person
    session.commit()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 1451, in commit
    self._transaction.commit(_to_root=self.future)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 827, in commit
    self._assert_active(prepared_ok=True)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (psycopg2.errors.ForeignKeyViolation) ОШИБКА:  INSERT или UPDATE в таблице "people" нарушает ограничение внешнего ключа "people_position_id_fkey"
DETAIL:  Ключ (position_id)=(4) отсутствует в таблице "position".

[SQL: INSERT INTO people (last_name, first_name, position_id) VALUES (%(last_name)s, %(first_name)s, %(position_id)s) RETURNING people.id]
[parameters: {'last_name': 'test', 'first_name': 'test', 'position_id': 4}]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
2022-12-11 15:22:04,175 INFO werkzeug Thread-4 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:22:04] "[35m[1mPOST /api/v1/add_person HTTP/1.1[0m" 500 -
2022-12-11 15:22:35,761 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 15:22:35,761 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 15:22:40,207 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:22:40] "OPTIONS /api/v1/add_person HTTP/1.1" 200 -
2022-12-11 15:22:40,473 ERROR app Thread-2 (process_request_thread) : Exception on /api/v1/add_person [POST]
Traceback (most recent call last):
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.ForeignKeyViolation: ОШИБКА:  INSERT или UPDATE в таблице "people" нарушает ограничение внешнего ключа "people_position_id_fkey"
DETAIL:  Ключ (position_id)=(4) отсутствует в таблице "position".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 101, in add_person
    session.commit()
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\sqlalchemy\orm\session.py", line 1451, in commit
    self._transaction.commit(_to_root=self.future)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\sqlalchemy\orm\session.py", line 829, in commit
    self._prepare_impl()
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\sqlalchemy\orm\session.py", line 808, in _prepare_impl
    self.session.flush()
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\sqlalchemy\orm\session.py", line 3444, in flush
    self._flush(objects)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\sqlalchemy\orm\session.py", line 3583, in _flush
    with util.safe_reraise():
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\sqlalchemy\util\compat.py", line 210, in raise_
    raise exception
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\sqlalchemy\orm\session.py", line 3544, in _flush
    flush_context.execute()
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 456, in execute
    rec.execute(self)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 630, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 245, in save_obj
    _emit_insert_statements(
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 1238, in _emit_insert_statements
    result = connection._execute_20(
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\sqlalchemy\util\compat.py", line 210, in raise_
    raise exception
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.ForeignKeyViolation) ОШИБКА:  INSERT или UPDATE в таблице "people" нарушает ограничение внешнего ключа "people_position_id_fkey"
DETAIL:  Ключ (position_id)=(4) отсутствует в таблице "position".

[SQL: INSERT INTO people (last_name, first_name, position_id) VALUES (%(last_name)s, %(first_name)s, %(position_id)s) RETURNING people.id]
[parameters: {'last_name': 'test', 'first_name': 'test', 'position_id': 4}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2022-12-11 15:22:40,582 INFO werkzeug Thread-2 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:22:40] "[35m[1mPOST /api/v1/add_person HTTP/1.1[0m" 500 -
2022-12-11 15:22:45,791 WARNING app Thread-4 (process_request_thread) : Exeption This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (psycopg2.errors.ForeignKeyViolation) ОШИБКА:  INSERT или UPDATE в таблице "people" нарушает ограничение внешнего ключа "people_position_id_fkey"
DETAIL:  Ключ (position_id)=(4) отсутствует в таблице "position".

[SQL: INSERT INTO people (last_name, first_name, position_id) VALUES (%(last_name)s, %(first_name)s, %(position_id)s) RETURNING people.id]
[parameters: {'last_name': 'test', 'first_name': 'test', 'position_id': 4}]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a) ocured
2022-12-11 15:22:45,793 ERROR app Thread-4 (process_request_thread) : Exception on /api/v1/get_all_people_data [GET]
Traceback (most recent call last):
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\flask\app.py", line 2162, in make_response
    raise TypeError(
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\flask\app.py", line 2158, in make_response
    rv = self.response_class.force_type(
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\werkzeug\wrappers\response.py", line 268, in force_type
    response = Response(*run_wsgi_app(response, environ))
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\werkzeug\test.py", line 1260, in run_wsgi_app
    for item in app_iter:
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\werkzeug\wsgi.py", line 500, in __next__
    return self._next()
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\werkzeug\wrappers\response.py", line 50, in _iter_encoded
    for item in iterable:
TypeError: 'PendingRollbackError' object is not iterable
The view function did not return a valid response. The return type must be a string, dict, list, tuple with headers or status, Response instance, or WSGI callable, but it was a HTTPException.
2022-12-11 15:22:45,819 INFO werkzeug Thread-4 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:22:45] "[35m[1mGET /api/v1/get_all_people_data HTTP/1.1[0m" 500 -
2022-12-11 15:22:53,035 WARNING app Thread-5 (process_request_thread) : Exeption This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (psycopg2.errors.ForeignKeyViolation) ОШИБКА:  INSERT или UPDATE в таблице "people" нарушает ограничение внешнего ключа "people_position_id_fkey"
DETAIL:  Ключ (position_id)=(4) отсутствует в таблице "position".

[SQL: INSERT INTO people (last_name, first_name, position_id) VALUES (%(last_name)s, %(first_name)s, %(position_id)s) RETURNING people.id]
[parameters: {'last_name': 'test', 'first_name': 'test', 'position_id': 4}]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a) ocured
2022-12-11 15:22:53,035 ERROR app Thread-5 (process_request_thread) : Exception on /api/v1/get_all_people_data [GET]
Traceback (most recent call last):
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\flask\app.py", line 2162, in make_response
    raise TypeError(
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\flask\app.py", line 2158, in make_response
    rv = self.response_class.force_type(
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\werkzeug\wrappers\response.py", line 268, in force_type
    response = Response(*run_wsgi_app(response, environ))
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\werkzeug\test.py", line 1260, in run_wsgi_app
    for item in app_iter:
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\werkzeug\wsgi.py", line 500, in __next__
    return self._next()
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\werkzeug\wrappers\response.py", line 50, in _iter_encoded
    for item in iterable:
TypeError: 'PendingRollbackError' object is not iterable
The view function did not return a valid response. The return type must be a string, dict, list, tuple with headers or status, Response instance, or WSGI callable, but it was a HTTPException.
2022-12-11 15:22:53,036 INFO werkzeug Thread-5 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:22:53] "[35m[1mGET /api/v1/get_all_people_data HTTP/1.1[0m" 500 -
2022-12-11 15:23:15,735 WARNING app Thread-6 (process_request_thread) : Exeption This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (psycopg2.errors.ForeignKeyViolation) ОШИБКА:  INSERT или UPDATE в таблице "people" нарушает ограничение внешнего ключа "people_position_id_fkey"
DETAIL:  Ключ (position_id)=(4) отсутствует в таблице "position".

[SQL: INSERT INTO people (last_name, first_name, position_id) VALUES (%(last_name)s, %(first_name)s, %(position_id)s) RETURNING people.id]
[parameters: {'last_name': 'test', 'first_name': 'test', 'position_id': 4}]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a) ocured
2022-12-11 15:23:15,737 ERROR app Thread-6 (process_request_thread) : Exception on /api/v1/get_all_people_data [GET]
Traceback (most recent call last):
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\flask\app.py", line 2162, in make_response
    raise TypeError(
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\flask\app.py", line 2158, in make_response
    rv = self.response_class.force_type(
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\werkzeug\wrappers\response.py", line 268, in force_type
    response = Response(*run_wsgi_app(response, environ))
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\werkzeug\test.py", line 1260, in run_wsgi_app
    for item in app_iter:
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\werkzeug\wsgi.py", line 500, in __next__
    return self._next()
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\werkzeug\wrappers\response.py", line 50, in _iter_encoded
    for item in iterable:
TypeError: 'PendingRollbackError' object is not iterable
The view function did not return a valid response. The return type must be a string, dict, list, tuple with headers or status, Response instance, or WSGI callable, but it was a HTTPException.
2022-12-11 15:23:15,738 INFO werkzeug Thread-6 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:23:15] "[35m[1mGET /api/v1/get_all_people_data HTTP/1.1[0m" 500 -
2022-12-11 15:23:35,660 WARNING app Thread-7 (process_request_thread) : Exeption This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (psycopg2.errors.ForeignKeyViolation) ОШИБКА:  INSERT или UPDATE в таблице "people" нарушает ограничение внешнего ключа "people_position_id_fkey"
DETAIL:  Ключ (position_id)=(4) отсутствует в таблице "position".

[SQL: INSERT INTO people (last_name, first_name, position_id) VALUES (%(last_name)s, %(first_name)s, %(position_id)s) RETURNING people.id]
[parameters: {'last_name': 'test', 'first_name': 'test', 'position_id': 4}]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a) ocured
2022-12-11 15:23:35,660 ERROR app Thread-7 (process_request_thread) : Exception on /api/v1/get_all_people_data [GET]
Traceback (most recent call last):
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\flask\app.py", line 2162, in make_response
    raise TypeError(
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\flask\app.py", line 2158, in make_response
    rv = self.response_class.force_type(
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\werkzeug\wrappers\response.py", line 268, in force_type
    response = Response(*run_wsgi_app(response, environ))
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\werkzeug\test.py", line 1260, in run_wsgi_app
    for item in app_iter:
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\werkzeug\wsgi.py", line 500, in __next__
    return self._next()
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\venv\lib\site-packages\werkzeug\wrappers\response.py", line 50, in _iter_encoded
    for item in iterable:
TypeError: 'PendingRollbackError' object is not iterable
The view function did not return a valid response. The return type must be a string, dict, list, tuple with headers or status, Response instance, or WSGI callable, but it was a HTTPException.
2022-12-11 15:23:35,661 INFO werkzeug Thread-7 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:23:35] "[35m[1mGET /api/v1/get_all_people_data HTTP/1.1[0m" 500 -
2022-12-11 15:28:32,261 INFO werkzeug MainThread : [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2022-12-11 15:28:32,261 INFO werkzeug MainThread : [33mPress CTRL+C to quit[0m
2022-12-11 15:28:34,987 INFO app Thread-2 (process_request_thread) : All users were selected from database
2022-12-11 15:28:34,988 INFO werkzeug Thread-2 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:28:34] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 15:28:35,014 INFO app Thread-3 (process_request_thread) : All users were selected from database
2022-12-11 15:28:35,015 INFO werkzeug Thread-3 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:28:35] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 15:28:47,745 ERROR app Thread-1 (process_request_thread) : Exception on /api/v1/num_visits [GET]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 598, in connect
    sock = self.retry.call_with_retry(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\retry.py", line 46, in call_with_retry
    return do()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 599, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 664, in _connect
    raise err
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 652, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [WinError 10061] Подключение не установлено, т.к. конечный компьютер отверг запрос на подключение

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 23, in num_visits
    count = get_hit_counts()
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\utils.py", line 12, in get_hit_counts
    raise exc
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\utils.py", line 9, in get_hit_counts
    return cache.incr('hits')
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\commands\core.py", line 1852, in incrby
    return self.execute_command("INCRBY", name, amount)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\client.py", line 1255, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 1389, in get_connection
    connection.connect()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\redis\connection.py", line 604, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 10061 connecting to 127.0.0.1:6379. Подключение не установлено, т.к. конечный компьютер отверг запрос на подключение.
2022-12-11 15:28:47,761 INFO werkzeug Thread-1 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:28:47] "[35m[1mGET /api/v1/num_visits HTTP/1.1[0m" 500 -
2022-12-11 15:28:57,957 INFO app Thread-4 (process_request_thread) : All users were selected from database
2022-12-11 15:28:57,958 INFO werkzeug Thread-4 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:28:57] "GET /api/v1/get_all_people_data HTTP/1.1" 200 -
2022-12-11 15:30:53,650 INFO werkzeug Thread-5 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:30:53] "OPTIONS /api/v1/add_person HTTP/1.1" 200 -
2022-12-11 15:30:53,904 ERROR app Thread-6 (process_request_thread) : Exception on /api/v1/add_person [POST]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.ForeignKeyViolation: ОШИБКА:  INSERT или UPDATE в таблице "people" нарушает ограничение внешнего ключа "people_position_id_fkey"
DETAIL:  Ключ (position_id)=(4) отсутствует в таблице "position".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 101, in add_person
    session.commit()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 1451, in commit
    self._transaction.commit(_to_root=self.future)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 829, in commit
    self._prepare_impl()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 808, in _prepare_impl
    self.session.flush()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 3386, in flush
    self._flush(objects)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 3525, in _flush
    with util.safe_reraise():
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 3486, in _flush
    flush_context.execute()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\unitofwork.py", line 456, in execute
    rec.execute(self)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\unitofwork.py", line 630, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\persistence.py", line 245, in save_obj
    _emit_insert_statements(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\persistence.py", line 1238, in _emit_insert_statements
    result = connection._execute_20(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.ForeignKeyViolation) ОШИБКА:  INSERT или UPDATE в таблице "people" нарушает ограничение внешнего ключа "people_position_id_fkey"
DETAIL:  Ключ (position_id)=(4) отсутствует в таблице "position".

[SQL: INSERT INTO people (last_name, first_name, position_id) VALUES (%(last_name)s, %(first_name)s, %(position_id)s) RETURNING people.id]
[parameters: {'last_name': 'new', 'first_name': 'new', 'position_id': 4}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2022-12-11 15:30:53,919 INFO werkzeug Thread-6 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:30:53] "[35m[1mPOST /api/v1/add_person HTTP/1.1[0m" 500 -
2022-12-11 15:31:05,961 WARNING app Thread-8 (process_request_thread) : Exeption This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (psycopg2.errors.ForeignKeyViolation) ОШИБКА:  INSERT или UPDATE в таблице "people" нарушает ограничение внешнего ключа "people_position_id_fkey"
DETAIL:  Ключ (position_id)=(4) отсутствует в таблице "position".

[SQL: INSERT INTO people (last_name, first_name, position_id) VALUES (%(last_name)s, %(first_name)s, %(position_id)s) RETURNING people.id]
[parameters: {'last_name': 'new', 'first_name': 'new', 'position_id': 4}]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a) ocured
2022-12-11 15:31:05,962 ERROR app Thread-8 (process_request_thread) : Exception on /api/v1/get_all_people_data [GET]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2162, in make_response
    raise TypeError(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2158, in make_response
    rv = self.response_class.force_type(
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\wrappers\response.py", line 268, in force_type
    response = Response(*run_wsgi_app(response, environ))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\test.py", line 1260, in run_wsgi_app
    for item in app_iter:
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\wsgi.py", line 500, in __next__
    return self._next()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\werkzeug\wrappers\response.py", line 50, in _iter_encoded
    for item in iterable:
TypeError: 'PendingRollbackError' object is not iterable
The view function did not return a valid response. The return type must be a string, dict, list, tuple with headers or status, Response instance, or WSGI callable, but it was a HTTPException.
2022-12-11 15:31:05,988 INFO werkzeug Thread-8 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:31:05] "[35m[1mGET /api/v1/get_all_people_data HTTP/1.1[0m" 500 -
2022-12-11 15:32:06,245 INFO werkzeug Thread-9 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:32:06] "OPTIONS /api/v1/add_person HTTP/1.1" 200 -
2022-12-11 15:32:06,510 ERROR app Thread-10 (process_request_thread) : Exception on /api/v1/add_person [POST]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 101, in add_person
    session.commit()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 1451, in commit
    self._transaction.commit(_to_root=self.future)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 827, in commit
    self._assert_active(prepared_ok=True)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (psycopg2.errors.ForeignKeyViolation) ОШИБКА:  INSERT или UPDATE в таблице "people" нарушает ограничение внешнего ключа "people_position_id_fkey"
DETAIL:  Ключ (position_id)=(4) отсутствует в таблице "position".

[SQL: INSERT INTO people (last_name, first_name, position_id) VALUES (%(last_name)s, %(first_name)s, %(position_id)s) RETURNING people.id]
[parameters: {'last_name': 'new', 'first_name': 'new', 'position_id': 4}]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
2022-12-11 15:32:06,510 INFO werkzeug Thread-10 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:32:06] "[35m[1mPOST /api/v1/add_person HTTP/1.1[0m" 500 -
2022-12-11 15:33:42,832 INFO werkzeug Thread-12 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:33:42] "OPTIONS /api/v1/add_person HTTP/1.1" 200 -
2022-12-11 15:33:43,098 ERROR app Thread-13 (process_request_thread) : Exception on /api/v1/add_person [POST]
Traceback (most recent call last):
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 2525, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1822, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask_cors\extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1820, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\flask\app.py", line 1796, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\ACER\Documents\2022_fall\БД\labs\main_project\server\app.py", line 101, in add_person
    session.commit()
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 1451, in commit
    self._transaction.commit(_to_root=self.future)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 827, in commit
    self._assert_active(prepared_ok=True)
  File "C:\Users\ACER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (psycopg2.errors.ForeignKeyViolation) ОШИБКА:  INSERT или UPDATE в таблице "people" нарушает ограничение внешнего ключа "people_position_id_fkey"
DETAIL:  Ключ (position_id)=(4) отсутствует в таблице "position".

[SQL: INSERT INTO people (last_name, first_name, position_id) VALUES (%(last_name)s, %(first_name)s, %(position_id)s) RETURNING people.id]
[parameters: {'last_name': 'new', 'first_name': 'new', 'position_id': 4}]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
2022-12-11 15:33:43,098 INFO werkzeug Thread-13 (process_request_thread) : 127.0.0.1 - - [11/Dec/2022 15:33:43] "[35m[1mPOST /api/v1/add_person HTTP/1.1[0m" 500 -
